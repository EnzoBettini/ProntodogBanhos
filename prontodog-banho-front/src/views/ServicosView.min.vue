<template><div class="min-h-screen bg-gray-50"><div class="relative overflow-hidden bg-gradient-to-r from-amber-700 via-yellow-600 to-amber-800 text-white pt-16"><div class="absolute inset-0 opacity-20"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent transform -skew-x-12 animate-pulse"></div></div><div class="relative z-20 max-w-7xl mx-auto px-4 py-12"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><div class="relative"><div class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-amber-500 rounded-2xl flex items-center justify-center shadow-2xl"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-2xl text-white drop-shadow-lg transform rotate-12 animate-bounce-gentle" /></div><div class="absolute -top-2 -right-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg animate-pulse">{{ servicosCount}} </div></div><div><h1 class="text-4xl font-bold flex items-center gap-3"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-yellow-300 animate-twinkle mr-1" />Gestão de Serviços </h1><p class="text-xl opacity-90 font-medium">Administração profissional de serviços</p></div></div><div class="flex gap-3"><RouterLink to="/servicos/novo" class="group bg-gradient-to-r from-green-600 to-emerald-700 hover:from-green-700 hover:to-emerald-800 px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 flex items-center gap-2" ><FontAwesomeIcon :icon="['fas', 'plus']" class="group-hover:rotate-90 transition-transform duration-300" />Novo Serviço </RouterLink><button class="group bg-gradient-to-r from-amber-600 to-yellow-700 hover:from-amber-700 hover:to-yellow-800 px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 flex items-center gap-2" ><FontAwesomeIcon :icon="['fas', 'chart-line']" class="group-hover:scale-110 transition-transform duration-300" />Relatórios </button></div></div></div><div class="absolute bottom-0 left-0 right-0 z-10"><svg viewBox="0 0 1440 120" class="w-full h-12"><defs><linearGradient id="waveGradient" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#10b981;stop-opacity:1" /><stop offset="50%" style="stop-color:#059669;stop-opacity:1" /><stop offset="100%" style="stop-color:#047857;stop-opacity:1" /></linearGradient></defs><path d="M0 60h1440V0c-120 40-240 60-360 60S840 40 720 60s-240 0-360-60S120 40 0 60z" fill="url(#waveGradient)"></path></svg></div></div><div class="max-w-7xl mx-auto px-4 py-8"><BaseCard class="mb-8 bg-gradient-to-r from-white via-yellow-50/30 to-amber-50/20"><div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"><div class="flex-1 max-w-md relative"><div class="relative group"><input type="text" v-model="filtroBusca" placeholder="Buscar por nome, descrição ou valor..." class="w-full pl-12 pr-4 py-3 border-2 border-amber-200 rounded-xl focus:border-amber-500 focus:ring-4 focus:ring-amber-500/20 transition-all duration-300 bg-white/80 backdrop-blur-sm" @input="resetarPaginacao" ><FontAwesomeIcon :icon="['fas', 'search']" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-amber-500 group-focus-within:text-amber-600 transition-colors" /></div><div v-if="filtroBusca" class="mt-2"><span class="inline-flex items-center gap-1 px-3 py-1 bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-700 rounded-full text-sm font-medium"><FontAwesomeIcon :icon="['fas', 'filter']" class="text-xs" />Buscando: "{{ filtroBusca}}" </span></div></div><div class="flex flex-wrap gap-4"><div class="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-amber-100 to-yellow-100 rounded-xl"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-amber-600" /><span class="text-sm font-medium text-amber-800">{{ totalItensDisponiveis}} de{{ servicosCount}} encontrados </span></div><div class="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl"><FontAwesomeIcon :icon="['fas', 'dollar-sign']" class="text-green-600" /><span class="text-sm font-medium text-green-800">Valor Total: R${{ valorTotalServicos}} </span></div></div></div></BaseCard><div v-if="loading" class="flex items-center justify-center py-20"><div class="text-center space-y-4"><div class="relative"><div class="w-16 h-16 bg-gradient-to-br from-amber-500 to-yellow-600 rounded-2xl flex items-center justify-center shadow-xl animate-bounce"><FontAwesomeIcon :icon="['fas', 'spinner']" class="text-2xl text-white animate-spin" /></div><div class="absolute inset-0 bg-gradient-to-r from-amber-400/30 to-yellow-500/30 rounded-2xl blur-xl animate-pulse"></div></div><div class="space-y-2"><h3 class="text-xl font-semibold text-gray-700">Carregando serviços...</h3><p class="text-gray-500">Organizando dados profissionais</p></div></div></div><div v-else-if="error" class="flex items-center justify-center py-20"><BaseCard class="text-center max-w-md bg-gradient-to-br from-red-50 to-pink-50 border-red-200"><div class="space-y-4"><div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto shadow-xl"><FontAwesomeIcon :icon="['fas', 'exclamation-triangle']" class="text-2xl text-white" /></div><div><h3 class="text-xl font-semibold text-red-700 mb-2">Erro ao carregar serviços</h3><p class="text-red-600 mb-4">{{ error}}</p><BaseButton variant="danger" @click="recarregarDados"><FontAwesomeIcon :icon="['fas', 'refresh']" class="mr-2" />Tentar Novamente </BaseButton></div></div></BaseCard></div><div v-else-if="isEmpty" class="flex items-center justify-center py-20"><BaseCard class="text-center max-w-md bg-gradient-to-br from-amber-50 to-yellow-50 border-amber-200"><div class="space-y-6"><div class="relative"><div class="w-20 h-20 bg-gradient-to-br from-amber-500 to-yellow-600 rounded-3xl flex items-center justify-center mx-auto shadow-xl"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-3xl text-white" /></div><div class="absolute -top-1 -right-1 w-8 h-8 bg-gradient-to-br from-orange-400 to-red-500 rounded-full flex items-center justify-center"><FontAwesomeIcon :icon="['fas', 'plus']" class="text-sm text-white" /></div></div><div><h3 class="text-2xl font-semibold text-amber-700 mb-2">Nenhum serviço cadastrado</h3><p class="text-amber-600 mb-6">Comece criando seu primeiro serviço profissional</p><RouterLink to="/servicos/novo"><BaseButton variant="primary" class="bg-gradient-to-r from-green-600 to-emerald-700 hover:from-green-700 hover:to-emerald-800"><FontAwesomeIcon :icon="['fas', 'plus']" class="mr-2" />Criar Primeiro Serviço </BaseButton></RouterLink></div></div></BaseCard></div><div v-else class="space-y-6"><div ref="servicosListRef" class="space-y-4"><div v-for="servico in servicosExibidos" :key="servico.id" class="group bg-gradient-to-r from-white via-white to-amber-50/30 rounded-2xl shadow-lg hover:shadow-2xl border border-amber-100/50 transition-all duration-300 transform hover:-translate-y-1 p-6 cursor-pointer" @click="visualizarServico(servico.id)" ><div class="flex items-start justify-between"><div class="flex gap-4 flex-1"><div class="relative flex-shrink-0"><div class="w-16 h-16 bg-gradient-to-br from-amber-500 to-yellow-600 rounded-2xl flex items-center justify-center shadow-lg"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-xl text-white drop-shadow-sm" /></div><div class="absolute -top-2 -right-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg">{{ servico.quantidade}}x </div></div><div class="flex-1 min-w-0"><div class="flex items-start justify-between mb-3"><div><h3 class="text-xl font-bold text-gray-800 group-hover:text-amber-700 transition-colors">{{ servico.nome}} </h3><p class="text-gray-600 text-sm line-clamp-2">{{ servico.descricao || 'Sem descrição disponível'}}</p></div><div class="text-right flex-shrink-0 ml-4"><div class="text-2xl font-bold text-green-600">R${{ formatarValor(servico.valor)}} </div><div class="text-sm text-gray-500">por unidade</div></div></div><div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"><div class="flex items-center gap-2 text-sm"><FontAwesomeIcon :icon="['fas', 'hashtag']" class="text-amber-600" /><span class="text-gray-600">ID: <span class="font-medium">{{ servico.id}}</span></span></div><div class="flex items-center gap-2 text-sm"><FontAwesomeIcon :icon="['fas', 'box']" class="text-blue-600" /><span class="text-gray-600">Qtd: <span class="font-medium">{{ servico.quantidade}}</span></span></div><div class="flex items-center gap-2 text-sm"><FontAwesomeIcon :icon="['fas', 'calendar']" class="text-purple-600" /><span class="text-gray-600">Agendamentos: <span class="font-medium">{{ servico.servicosAnimais?.length || 0}}</span></span></div><div class="flex items-center gap-2 text-sm"><FontAwesomeIcon :icon="['fas', 'dollar-sign']" class="text-green-600" /><span class="text-gray-600">Total: <span class="font-medium text-green-600">R${{ formatarValor(servico.valor * servico.quantidade)}}</span></span></div></div><div class="flex items-center justify-between pt-3 border-t border-gray-100"><div class="flex gap-2"><button @click.stop="editarServico(servico.id)" class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg text-sm font-medium transition-all duration-300 transform hover:scale-105" ><FontAwesomeIcon :icon="['fas', 'edit']" />Editar </button><button @click.stop="excluirServico(servico.id)" class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white rounded-lg text-sm font-medium transition-all duration-300 transform hover:scale-105" ><FontAwesomeIcon :icon="['fas', 'trash']" />Excluir </button></div><FontAwesomeIcon :icon="['fas', 'chevron-right']" class="text-amber-500 group-hover:text-amber-600 group-hover:translate-x-1 transition-all duration-300" /></div></div></div></div></div></div><div v-if="temMaisItens" class="text-center py-6"><BaseButton @click="carregarMais" variant="secondary" class="bg-gradient-to-r from-amber-600 to-yellow-700 hover:from-amber-700 hover:to-yellow-800 text-white border-0 px-8 py-3 text-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1" ><FontAwesomeIcon :icon="['fas', 'plus-circle']" class="mr-2" />Carregar Mais Serviços <span class="ml-2 bg-white/20 px-2 py-1 rounded-full text-sm">+{{ Math.min(itensPorPagina, totalItensDisponiveis - itensExibidos)}} </span></BaseButton></div></div><BaseCard v-if="hasData" class="mt-8 bg-gradient-to-r from-gray-50 via-amber-50/30 to-yellow-50/20 border-amber-200/50"><div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"><div class="flex items-center gap-6"><div class="flex items-center gap-2 text-amber-700"><FontAwesomeIcon :icon="['fas', 'cog']" class="text-lg" /><span class="font-semibold">{{ servicosCount}} serviços cadastrados</span></div><div class="flex items-center gap-2 text-green-700"><FontAwesomeIcon :icon="['fas', 'dollar-sign']" class="text-lg" /><span class="font-semibold">R${{ valorTotalServicos}} em serviços</span></div></div><div class="text-sm text-gray-500 flex items-center gap-2"><FontAwesomeIcon :icon="['fas', 'clock']" />Atualizado às{{ formatarHorario()}} </div></div></BaseCard></div></div></template><script setup lang="ts">import{ ref, computed, onMounted, watch} from 'vue'import{ useRouter} from 'vue-router'import{ BaseCard, BaseButton} from '@/components/UI'import{ servicosService} from '@/services/api'import{ useAsyncList} from '@/composables/useAsyncState'import{ useAutoAnimateList} from '@/composables/useAutoAnimate'import{ formatarHorario} from '@/utils/formatters'import type{ ServicoCompleto} from '@/types/api'// 🎯 Configuração inicialconst router=useRouter()// 📊 Estados da listaconst{ items: servicos, loading, error, isEmpty, hasData, execute: carregarServicos, reset: resetarServicos}=useAsyncList<ServicoCompleto>()// 🔍 Estados de busca e paginaçãoconst filtroBusca=ref('')const itensPorPagina=ref(10)const itensExibidos=ref(10)// 📋 Referência para animaçõesconst servicosListRef=ref<HTMLElement>()useAutoAnimateList(servicosListRef)// 💡 Computed propertiesconst servicosFiltrados=computed(()=>{ if (!servicos.value) return [] if (!filtroBusca.value.trim()){ return servicos.value} const termoBusca=filtroBusca.value.toLowerCase().trim() return servicos.value.filter(servico=>{ const nomeMatch=servico.nome?.toLowerCase().includes(termoBusca) const descricaoMatch=servico.descricao?.toLowerCase().includes(termoBusca) const valorMatch=servico.valor?.toString().includes(termoBusca) const idMatch=servico.id?.toString().includes(termoBusca) return nomeMatch || descricaoMatch || valorMatch || idMatch})})const servicosExibidos=computed(()=>{ return servicosFiltrados.value.slice(0, itensExibidos.value)})const temMaisItens=computed(()=>{ return itensExibidos.value < servicosFiltrados.value.length})const totalItensDisponiveis=computed(()=>{ return servicosFiltrados.value.length})const servicosCount=computed(()=>{ return servicos.value?.length || 0})const valorTotalServicos=computed(()=>{ if (!servicos.value) return '0,00' const total=servicos.value.reduce((acc, servico)=>{ return acc + (servico.valor * servico.quantidade)}, 0) return formatarValor(total)})// 🔧 Funções utilitáriasconst formatarValor=(valor: number): string=>{ return valor.toLocaleString('pt-BR',{ minimumFractionDigits: 2, maximumFractionDigits: 2})}const carregarMais=()=>{ itensExibidos.value +=itensPorPagina.value}const resetarPaginacao=()=>{ itensExibidos.value=itensPorPagina.value}const visualizarServico=(id: number)=>{ console.log('🔍 Visualizando serviço:', id) // TODO: Implementar modal de visualização ou navegação}const editarServico=(id: number)=>{ console.log('✏️ Editando serviço:', id) // TODO: Implementar edição de serviço router.push(`/servicos/${id}/editar`)}const excluirServico=async (id: number)=>{ if (!confirm('Tem certeza que deseja excluir este serviço?')) return try{ await servicosService.excluir(id) console.log('✅ Serviço excluído com sucesso!') recarregarDados()} catch (error){ console.error('❌ Erro ao excluir serviço:', error) alert('Erro ao excluir serviço. Tente novamente.')}}const recarregarDados=()=>{ carregarServicos(()=>servicosService.buscarTodos())}// 👀 Watcherswatch(filtroBusca, ()=>{ resetarPaginacao()})// 🎬 LifecycleonMounted(()=>{ recarregarDados()})</script><style scoped>.line-clamp-2{ display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden}</style>