<template><div class="min-h-screen bg-gray-50"><div class="relative overflow-hidden bg-gradient-to-r from-emerald-600 via-green-600 to-emerald-700 text-white pt-16"><div class="absolute inset-0 opacity-10"><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 animate-pulse"></div></div><div class="relative z-20 max-w-6xl mx-auto px-4 py-12"><div class="text-center space-y-4"><div class="flex justify-center mb-6"><div class="relative"><div class="w-20 h-20 bg-gradient-to-br from-emerald-400 to-green-500 rounded-3xl flex items-center justify-center shadow-2xl"><FontAwesomeIcon :icon="['fas', 'user']" class="text-3xl text-white drop-shadow-lg transform rotate-12 animate-bounce-gentle" /></div><div class="absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center shadow-lg"><FontAwesomeIcon :icon="['fas', 'eye']" class="text-sm text-white animate-pulse" /></div></div></div><div class="space-y-2"><h1 class="text-4xl font-bold"><FontAwesomeIcon :icon="['fas', 'user']" class="text-emerald-300 mr-2 animate-twinkle" />Perfil do Cliente </h1><p class="text-xl text-white opacity-90 font-medium">Visualize e gerencie informa√ß√µes do cliente </p><div v-if="cliente" class="text-lg text-emerald-100 font-medium mt-4">üë§ Cliente: <span class="font-bold">{{ cliente.nomeCompleto || 'Carregando...'}}</span></div></div></div></div><div class="absolute bottom-0 left-0 right-0 z-10 overflow-hidden"><svg viewBox="0 0 1440 100" class="w-full h-20" preserveAspectRatio="none"><defs><linearGradient id="waveGradientEditarCliente" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.9" /><stop offset="30%" style="stop-color:#2563eb;stop-opacity:0.8" /><stop offset="70%" style="stop-color:#1d4ed8;stop-opacity:0.7" /><stop offset="100%" style="stop-color:#1e40af;stop-opacity:0.6" /></linearGradient><filter id="waveShadowEditarCliente"><feDropShadow dx="0" dy="2" stdDeviation="4" flood-opacity="0.2"/></filter></defs><path d="M0,50 C240,30 480,70 720,50 C960,30 1200,70 1440,50 L1440,100 L0,100 Z" fill="url(#waveGradientEditarCliente)" filter="url(#waveShadowEditarCliente)" /><path d="M0,60 C360,35 600,75 960,55 C1200,35 1320,80 1440,60 L1440,100 L0,100 Z" fill="url(#waveGradientEditarCliente)" opacity="0.4" /></svg></div></div><div v-if="loading" class="max-w-6xl mx-auto px-4 py-8"><div class="flex items-center justify-center py-20"><div class="text-center space-y-4"><div class="relative"><div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl flex items-center justify-center shadow-xl animate-bounce"><FontAwesomeIcon :icon="['fas', 'spinner']" class="text-2xl text-white animate-spin" /></div><div class="absolute inset-0 bg-gradient-to-r from-emerald-400/30 to-green-500/30 rounded-2xl blur-xl animate-pulse"></div></div><div class="space-y-2"><h3 class="text-xl font-semibold text-gray-700">Carregando dados do cliente...</h3><p class="text-gray-500">ID:{{ $route.params.id}}</p></div></div></div></div><div v-else-if="error" class="max-w-6xl mx-auto px-4 py-8"><div class="flex items-center justify-center py-20"><BaseCard class="text-center max-w-md bg-gradient-to-br from-red-50 to-pink-50 border-red-200"><div class="space-y-4"><div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto shadow-xl"><FontAwesomeIcon :icon="['fas', 'exclamation-triangle']" class="text-2xl text-white" /></div><div><h3 class="text-xl font-semibold text-red-700 mb-2">Erro ao carregar cliente</h3><p class="text-red-600 mb-4">{{ error}}</p><div class="flex gap-3 justify-center"><BaseButton variant="secondary" @click="carregarCliente"><FontAwesomeIcon :icon="['fas', 'refresh']" class="mr-2" />Tentar Novamente </BaseButton><RouterLink to="/clientes"><BaseButton variant="primary"><FontAwesomeIcon :icon="['fas', 'arrow-left']" class="mr-2" />Voltar √† Lista </BaseButton></RouterLink></div></div></div></BaseCard></div></div><div v-else-if="cliente" class="max-w-6xl mx-auto px-4 py-8 space-y-8"><BaseCard class="bg-gradient-to-r from-white via-emerald-50/30 to-green-50/20 rounded-2xl shadow-lg border border-emerald-200/50 overflow-hidden animate-fade-in-up"><template #header><div class="bg-gradient-to-r from-emerald-600 to-green-700 px-6 py-4"><div class="flex items-center justify-between"><h3 class="text-xl font-bold text-white flex items-center gap-3"><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center"><FontAwesomeIcon :icon="['fas', 'id-card']" class="text-white" /></div>Informa√ß√µes Pessoais </h3><BaseButton variant="secondary" size="sm" @click="editarCliente" class="bg-white/20 hover:bg-white/30 text-white border-white/20"><FontAwesomeIcon :icon="['fas', 'edit']" class="mr-2" />Editar </BaseButton></div></div></template><div class="p-6"><div class="grid md:grid-cols-3 gap-6"><div class="flex items-center gap-3"><FontAwesomeIcon :icon="['fas', 'hashtag']" class="text-emerald-600" /><div><label class="block text-sm font-medium text-gray-600">ID Sistema</label><p class="text-lg font-semibold text-gray-900">{{ cliente.codigoClienteSistema}}</p></div></div><div class="flex items-center gap-3"><FontAwesomeIcon :icon="['fas', 'id-card']" class="text-emerald-600" /><div><label class="block text-sm font-medium text-gray-600">CPF</label><p class="text-lg font-semibold text-gray-900">{{ formatarCpf(cliente.cpf)}}</p></div></div><div class="flex items-center gap-3"><FontAwesomeIcon :icon="['fas', 'code']" class="text-emerald-600" /><div><label class="block text-sm font-medium text-gray-600">C√≥digo SimplesVet</label><p class="text-lg font-semibold text-gray-900">{{ cliente.codigoSimplesVet || 'N√£o informado'}}</p></div></div></div></div></BaseCard><BaseCard v-if="cliente.telefones?.length || cliente.emailClientes?.length" class="bg-gradient-to-r from-white via-blue-50/30 to-indigo-50/20 rounded-2xl shadow-lg border border-blue-200/50 overflow-hidden animate-fade-in-up"><template #header><div class="bg-gradient-to-r from-blue-600 to-indigo-700 px-6 py-4"><h3 class="text-xl font-bold text-white flex items-center gap-3"><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center"><FontAwesomeIcon :icon="['fas', 'phone']" class="text-white" /></div>Contatos </h3></div></template><div class="p-6"><div class="grid md:grid-cols-2 gap-6"><div v-if="cliente.telefones?.length"><label class="block text-sm font-medium text-gray-700 mb-3 flex items-center gap-2"><FontAwesomeIcon :icon="['fas', 'phone']" class="text-blue-600" />Telefones </label><div class="space-y-2"><div v-for="(telefone, index) in cliente.telefones" :key="telefone.id" class="flex items-center gap-2 p-3 bg-blue-50 rounded-lg" ><FontAwesomeIcon :icon="['fas', 'phone']" class="text-blue-500 text-sm" /><span class="font-medium text-gray-900">{{ formatarTelefone(telefone.telefone)}}</span><BaseBadge v-if="index===0" variant="primary" size="sm">Principal</BaseBadge></div></div></div><div v-if="cliente.emailClientes?.length"><label class="block text-sm font-medium text-gray-700 mb-3 flex items-center gap-2"><FontAwesomeIcon :icon="['fas', 'envelope']" class="text-blue-600" />Emails </label><div class="space-y-2"><div v-for="(emailCliente, index) in cliente.emailClientes" :key="emailCliente.id" class="flex items-center gap-2 p-3 bg-indigo-50 rounded-lg" ><FontAwesomeIcon :icon="['fas', 'envelope']" class="text-indigo-500 text-sm" /><span class="font-medium text-gray-900">{{ emailCliente.email}}</span><BaseBadge v-if="index===0" variant="primary" size="sm">Principal</BaseBadge></div></div></div></div></div></BaseCard><BaseCard class="bg-gradient-to-r from-white via-purple-50/30 to-pink-50/20 rounded-2xl shadow-lg border border-purple-200/50 overflow-hidden animate-fade-in-up"><template #header><div class="bg-gradient-to-r from-purple-600 to-pink-700 px-6 py-4"><div class="flex items-center justify-between"><h3 class="text-xl font-bold text-white flex items-center gap-3"><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center"><FontAwesomeIcon :icon="['fas', 'dog']" class="text-white" /></div>Animais ({{ cliente.animais?.length || 0}}) </h3><BaseButton variant="secondary" size="sm" @click="adicionarAnimal" class="bg-white/20 hover:bg-white/30 text-white border-white/20"><FontAwesomeIcon :icon="['fas', 'plus']" class="mr-2" />Adicionar Animal </BaseButton></div></div></template><div class="p-6"><div v-if="!cliente.animais?.length" class="text-center py-12 text-gray-500"><div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"><FontAwesomeIcon :icon="['fas', 'dog']" class="text-4xl text-gray-400" /></div><p class="text-lg font-medium mb-2">Nenhum animal cadastrado</p><p class="text-sm text-gray-600 mb-4">Este cliente ainda n√£o possui animais cadastrados.</p><BaseButton variant="primary" @click="adicionarAnimal"><FontAwesomeIcon :icon="['fas', 'plus']" class="mr-2" />Adicionar Primeiro Animal </BaseButton></div><div v-else class="grid gap-4"><div v-for="animal in cliente.animais" :key="animal.id" class="group border border-gray-200 rounded-xl p-4 hover:border-purple-200 hover:shadow-md transition-all duration-300 bg-gradient-to-r from-white to-purple-50/30" ><div class="flex items-center justify-between"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform"><FontAwesomeIcon :icon="['fas', 'dog']" class="text-white" /></div><div><h4 class="text-lg font-semibold text-gray-900">{{ animal.nome}}</h4><div class="flex items-center gap-4 text-sm text-gray-600"><span class="flex items-center gap-1"><FontAwesomeIcon :icon="['fas', 'heart']" class="text-pink-500" />{{ animal.tipo}} </span><span>‚Ä¢</span><span class="flex items-center gap-1"><FontAwesomeIcon :icon="['fas', 'qrcode']" class="text-purple-500" />SimplesVet:{{ animal.codigoSimplesVet || 'N/A'}} </span></div></div></div><div class="flex items-center gap-3"><BaseBadge :variant="animal.servicos?.length ? 'success' : 'gray'" size="sm" >{{ animal.servicos?.length || 0}} servi√ßo{{ (animal.servicos?.length || 0) !==1 ? 's' : ''}} </BaseBadge><button @click="verAnimal(animal)" class="w-10 h-10 bg-purple-100 hover:bg-purple-200 text-purple-600 rounded-full flex items-center justify-center transition-all duration-300 transform hover:scale-110" title="Ver detalhes do animal" ><FontAwesomeIcon :icon="['fas', 'eye']" /></button></div></div></div></div></div></BaseCard><BaseCard class="bg-gradient-to-r from-white via-gray-50/50 to-blue-50/30 rounded-2xl shadow-lg border border-gray-200/50 overflow-hidden animate-fade-in-up"><template #header><div class="bg-gradient-to-r from-gray-700 to-gray-800 px-6 py-4"><h3 class="text-xl font-bold text-white flex items-center gap-3"><div class="w-8 h-8 bg-white/20 rounded-lg flex items-center justify-center"><FontAwesomeIcon :icon="['fas', 'chart-bar']" class="text-white" /></div>Estat√≠sticas do Cliente </h3></div></template><div class="p-6"><div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200/50"><div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-2"><FontAwesomeIcon :icon="['fas', 'dog']" class="text-white" /></div><div class="text-2xl font-bold text-blue-600">{{ cliente.animais?.length || 0}}</div><div class="text-sm text-blue-600 font-medium">Animais</div></div><div class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200/50"><div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-2"><FontAwesomeIcon :icon="['fas', 'scissors']" class="text-white" /></div><div class="text-2xl font-bold text-green-600">{{ totalServicos}}</div><div class="text-sm text-green-600 font-medium">Servi√ßos</div></div><div class="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200/50"><div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-2"><FontAwesomeIcon :icon="['fas', 'phone']" class="text-white" /></div><div class="text-2xl font-bold text-purple-600">{{ cliente.telefones?.length || 0}}</div><div class="text-sm text-purple-600 font-medium">Telefones</div></div><div class="text-center p-4 bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl border border-orange-200/50"><div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-2"><FontAwesomeIcon :icon="['fas', 'envelope']" class="text-white" /></div><div class="text-2xl font-bold text-orange-600">{{ cliente.emailClientes?.length || 0}}</div><div class="text-sm text-orange-600 font-medium">Emails</div></div></div></div></BaseCard><div class="flex flex-col sm:flex-row gap-4 justify-between items-center bg-white rounded-2xl shadow-lg p-6 border border-gray-200/50 animate-fade-in-up"><div class="text-sm text-gray-500 flex items-center gap-2"><FontAwesomeIcon :icon="['fas', 'calendar-days']" />Cliente desde{{ formatarData(cliente.id)}} </div><div class="flex flex-col sm:flex-row gap-3"><RouterLink to="/clientes"><button type="button" class="w-full sm:w-auto px-6 py-3 text-lg font-medium border-2 border-gray-300 hover:border-gray-400 bg-white hover:bg-gray-50 text-gray-700 hover:text-gray-800 rounded-lg transition-all duration-300 flex items-center justify-center gap-2" ><FontAwesomeIcon :icon="['fas', 'arrow-left']" />Voltar √† Lista </button></RouterLink><BaseButton variant="secondary" @click="editarCliente" class="bg-gradient-to-r from-emerald-600 to-green-700 hover:from-emerald-700 hover:to-green-800 px-6 py-3 text-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border-0" ><FontAwesomeIcon :icon="['fas', 'edit']" class="mr-2" />Editar Cliente </BaseButton><BaseButton variant="danger" @click="confirmarExclusao" :disabled="excluindo" class="px-6 py-3 text-lg font-medium shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1" ><FontAwesomeIcon :icon="excluindo ? 'spinner' : 'trash'" :class="{ 'animate-spin': excluindo}" class="mr-2" />{{ excluindo ? 'Excluindo...' : 'Excluir Cliente'}} </BaseButton></div></div></div><ClienteEditModal :is-open="modalEdicaoAberto" :cliente="cliente" @close="fecharModalEdicao" @cliente-atualizado="onClienteEditado" /><div v-if="excluindo" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50"><div class="bg-white rounded-2xl p-8 shadow-2xl max-w-sm w-full mx-4"><div class="text-center space-y-4"><div class="relative mx-auto w-16 h-16"><div class="absolute inset-0 bg-gradient-to-r from-red-400 to-pink-500 rounded-2xl animate-pulse"></div><div class="relative w-16 h-16 bg-gradient-to-br from-red-500 to-pink-600 rounded-2xl flex items-center justify-center shadow-xl"><FontAwesomeIcon :icon="['fas', 'trash']" class="text-2xl text-white animate-pulse" /></div></div><div><h3 class="text-lg font-semibold text-gray-800">Excluindo Cliente</h3><p class="text-gray-600">Aguarde...</p></div></div></div></div></div></template><script setup lang="ts">import{ ref, computed, onMounted} from 'vue'import{ useRouter, useRoute} from 'vue-router'import{ BaseCard, BaseButton, BaseBadge} from '@/components/UI'import ClienteEditModal from '@/components/UI/ClienteEditModal.vue'import{ clientesService} from '@/services/api'import type{ Cliente, Animal} from '@/types/api'// üéØ Configura√ß√£o inicialconst router=useRouter()const route=useRoute()// üìã Estados do componenteconst cliente=ref<Cliente | null>(null)const loading=ref(true)const error=ref<string | null>(null)const excluindo=ref(false)// üé≠ Modal de edi√ß√£oconst modalEdicaoAberto=ref(false)// üí° Computed propertiesconst clienteId=computed(()=>Number(route.params.id))const totalServicos=computed(()=>{ return cliente.value?.animais?.reduce((total, animal)=>{ return total + (animal.servicos?.length || 0)}, 0) || 0})// üîß Fun√ß√µes utilit√°riasconst formatarCpf=(cpf: string): string=>{ if (!cpf) return 'N/A' return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4')}const formatarTelefone=(telefone: string): string=>{ if (!telefone) return 'N/A' return telefone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3')}const formatarData=(id: number): string=>{ // Simula uma data baseada no ID (apenas para demonstra√ß√£o) const dataBase=new Date('2024-01-01') dataBase.setDate(dataBase.getDate() + id) // Usar formata√ß√£o local para evitar timezone issues return dataBase.toLocaleDateString('pt-BR')}// üéØ A√ß√µes principaisconst carregarCliente=async ()=>{ loading.value=true error.value=null try{ console.log('üîÑ Carregando dados do cliente...') cliente.value=await clientesService.buscarPorId(clienteId.value) console.log('‚úÖ Cliente carregado:', cliente.value.nomeCompleto)} catch (err){ console.error('‚ùå Erro ao carregar cliente:', err) error.value=err instanceof Error ? err.message : 'Erro inesperado ao carregar cliente'} finally{ loading.value=false}}const editarCliente=(): void=>{ console.log('‚úèÔ∏è Editar cliente:', cliente.value?.nomeCompleto) modalEdicaoAberto.value=true}const fecharModalEdicao=(): void=>{ modalEdicaoAberto.value=false}const onClienteEditado=(clienteAtualizado: Cliente): void=>{ // Atualiza os dados do cliente na p√°gina atual cliente.value=clienteAtualizado console.log('‚úÖ Cliente atualizado na p√°gina de perfil')}const adicionarAnimal=(): void=>{ console.log('‚ûï Adicionar animal para:', cliente.value?.nomeCompleto) router.push('/animais/novo')}const verAnimal=(animal: Animal): void=>{ console.log('üëÅÔ∏è Ver animal:', animal.nome) router.push(`/animais/${animal.id}/editar`)}const confirmarExclusao=(): void=>{ if (!cliente.value) return const confirmacao=confirm( `‚ö†Ô∏è ATEN√á√ÉO!\n\nTem certeza que deseja excluir o cliente "${cliente.value.nomeCompleto}"?\n\n` + `Esta a√ß√£o N√ÉO pode ser desfeita e ir√°:\n` + `‚Ä¢ Remover permanentemente o cliente\n` + `‚Ä¢ Remover todos os ${cliente.value.animais?.length || 0} animais cadastrados\n` + `‚Ä¢ Remover todo o hist√≥rico de servi√ßos\n\n` + `Digite "EXCLUIR" abaixo para confirmar:` ) if (confirmacao){ const confirmacaoTexto=prompt('Digite "EXCLUIR" para confirmar:') if (confirmacaoTexto==='EXCLUIR'){ excluirCliente()} else{ alert('Exclus√£o cancelada. Texto de confirma√ß√£o incorreto.')}}}const excluirCliente=async (): Promise<void>=>{ if (!cliente.value) return try{ console.log('üóëÔ∏è Excluindo cliente...') excluindo.value=true await clientesService.excluir(cliente.value.id) console.log('‚úÖ Cliente exclu√≠do com sucesso!') alert(`Cliente "${cliente.value.nomeCompleto}" foi exclu√≠do com sucesso!`) router.push('/clientes')} catch (err){ console.error('‚ùå Erro ao excluir cliente:', err) const mensagem=err instanceof Error ? err.message : 'Erro inesperado ao excluir cliente' alert(`Erro ao excluir cliente:\n${mensagem}`)} finally{ excluindo.value=false}}// üé¨ LifecycleonMounted(()=>{ carregarCliente()})</script><style scoped></style>