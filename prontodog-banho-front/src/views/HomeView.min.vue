<template><div class="relative min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-zinc-50 p-4 pb-8"><div class="absolute inset-0 overflow-hidden pointer-events-none z-0"><div class="absolute top-10 left-10 w-96 h-96 bg-gradient-to-br from-indigo-500/8 to-purple-500/8 rounded-full blur-3xl animate-pulse"></div><div class="absolute bottom-10 right-10 w-80 h-80 bg-gradient-to-br from-emerald-500/8 to-teal-500/8 rounded-full blur-3xl animate-pulse delay-1000"></div><div class="absolute top-1/3 right-1/4 w-64 h-64 bg-gradient-to-br from-rose-500/4 to-pink-500/4 rounded-full blur-2xl"></div><div class="absolute top-1/4 left-1/3 w-32 h-32 bg-gradient-to-br from-yellow-400/5 to-orange-400/5 rounded-full blur-xl animate-pulse delay-500"></div><div class="absolute bottom-1/4 left-1/4 w-48 h-48 bg-gradient-to-br from-blue-400/6 to-cyan-400/6 rounded-full blur-2xl animate-pulse delay-2000"></div><div class="absolute inset-0 opacity-20"><svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="dots" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse"><circle cx="20" cy="20" r="1.5" fill="#64748b" opacity="0.3"/></pattern><pattern id="lines" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse"><path d="M0 60 L60 0" stroke="#64748b" stroke-width="0.5" opacity="0.2"/></pattern></defs><rect width="100%" height="100%" fill="url(#dots)"/><rect width="100%" height="100%" fill="url(#lines)"/></svg></div><div class="absolute inset-0 bg-gradient-to-br from-indigo-50/30 via-transparent via-purple-50/20 to-emerald-50/30"></div></div><div class="relative z-20 max-w-7xl mx-auto pt-8"><div v-if="loading" class="text-center py-12"><div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-400 to-green-500 rounded-full mb-4 animate-spin"><FontAwesomeIcon :icon="['fas', 'spinner']" class="text-white text-2xl" /></div><p class="text-gray-600 text-lg">Carregando dashboard...</p></div><div v-else-if="error" class="text-center py-12"><div class="inline-flex items-center justify-center w-16 h-16 bg-red-500 rounded-full mb-4"><FontAwesomeIcon :icon="['fas', 'exclamation-triangle']" class="text-white text-2xl" /></div><h3 class="text-xl font-semibold text-gray-800 mb-2">Erro ao carregar dashboard</h3><p class="text-gray-600 mb-4">{{ error}}</p><button @click="carregarDados" class="flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors mx-auto" ><FontAwesomeIcon :icon="['fas', 'refresh']" />Tentar Novamente </button></div><div v-else><div class="relative overflow-hidden rounded-3xl bg-gradient-to-br from-slate-900 via-gray-900 to-zinc-900 text-white p-8 mb-10 shadow-2xl border border-white/10"><div class="absolute top-0 right-0 w-72 h-72 bg-gradient-to-br from-violet-400/20 to-purple-600/20 rounded-full blur-3xl transform translate-x-32 -translate-y-32"></div><div class="absolute bottom-0 left-0 w-64 h-64 bg-gradient-to-br from-emerald-400/15 to-teal-600/15 rounded-full blur-2xl transform -translate-x-24 translate-y-24"></div><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent"></div><div class="relative z-10"><div class="flex items-center justify-between"><div class="space-y-2"><div class="flex items-center gap-3 mb-3"><div class="w-12 h-12 bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg"><span class="text-2xl">üêï</span></div><h1 class="text-4xl font-black tracking-tight bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent">ProntoDog </h1></div><p class="text-xl text-gray-300 font-medium">{{ saudacao}}, administrador!</p><div class="flex items-center gap-2 text-gray-400"><FontAwesomeIcon :icon="['fas', 'calendar-alt']" class="w-4 h-4" /><p class="text-sm font-medium">{{ dataAtual}}</p></div></div><button @click="carregarDados" :disabled="loading" class="group relative flex items-center gap-3 px-6 py-3 bg-white/10 backdrop-blur-xl rounded-2xl hover:bg-white/20 transition-all duration-300 border border-white/20 hover:border-white/30 transform hover:-translate-y-1 hover:shadow-2xl disabled:opacity-50 overflow-hidden" ><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div><FontAwesomeIcon :icon="['fas', 'refresh']" :class="{ 'animate-spin': loading, 'group-hover:rotate-180': !loading}" class="w-5 h-5 transition-transform duration-500" /><span class="font-semibold tracking-wide">{{ loading ? 'Carregando...' : 'Atualizar'}}</span></button></div></div></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12"><div class="group relative overflow-hidden rounded-3xl bg-gradient-to-br from-emerald-50/80 to-green-100/80 backdrop-blur-sm border border-emerald-200/50 p-8 hover:shadow-2xl hover:shadow-emerald-500/10 transition-all duration-500 hover:-translate-y-2"><div class="absolute inset-0 bg-gradient-to-br from-emerald-400/5 to-green-600/5"></div><div class="relative"><div class="flex items-start justify-between mb-6"><div class="p-4 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'dollar-sign']" class="text-white text-2xl" /></div><div class="w-2 h-2 bg-emerald-400 rounded-full opacity-50 group-hover:opacity-100 transition-opacity"></div></div><div class="space-y-2"><p class="text-sm font-semibold text-emerald-700/80 uppercase tracking-wider">Receita do M√™s</p><p class="text-3xl font-black text-gray-900 tracking-tight">{{ formatarValor(metricas.receitaTotal)}}</p><div class="flex items-center gap-2 text-emerald-600"><div class="w-1 h-1 bg-emerald-500 rounded-full"></div><p class="text-xs font-medium">Pagamentos de{{ new Date().toLocaleDateString('pt-BR',{ month: 'long'})}}</p></div></div></div></div><div class="group relative overflow-hidden rounded-3xl bg-gradient-to-br from-amber-50/80 to-orange-100/80 backdrop-blur-sm border border-amber-200/50 p-8 hover:shadow-2xl hover:shadow-amber-500/10 transition-all duration-500 hover:-translate-y-2"><div class="absolute inset-0 bg-gradient-to-br from-amber-400/5 to-orange-600/5"></div><div class="relative"><div class="flex items-start justify-between mb-6"><div class="p-4 bg-gradient-to-br from-amber-500 to-orange-600 rounded-2xl shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'clock']" class="text-white text-2xl animate-pulse" /></div><div class="w-2 h-2 bg-amber-400 rounded-full opacity-50 group-hover:opacity-100 transition-opacity"></div></div><div class="space-y-2"><p class="text-sm font-semibold text-amber-700/80 uppercase tracking-wider">Em Aberto</p><p class="text-3xl font-black text-gray-900 tracking-tight">{{ formatarValor(metricas.valorEmAberto)}}</p><div class="flex items-center gap-2 text-amber-600"><div class="w-1 h-1 bg-amber-500 rounded-full"></div><p class="text-xs font-medium">Cadastrados em{{ new Date().toLocaleDateString('pt-BR',{ month: 'long'})}}</p></div></div></div></div><div class="group relative overflow-hidden rounded-3xl bg-gradient-to-br from-rose-50/80 to-red-100/80 backdrop-blur-sm border border-rose-200/50 p-8 hover:shadow-2xl hover:shadow-rose-500/10 transition-all duration-500 hover:-translate-y-2"><div class="absolute inset-0 bg-gradient-to-br from-rose-400/5 to-red-600/5"></div><div class="relative"><div class="flex items-start justify-between mb-6"><div class="p-4 bg-gradient-to-br from-rose-500 to-red-600 rounded-2xl shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'exclamation-triangle']" class="text-white text-2xl" /></div><div class="w-2 h-2 bg-rose-400 rounded-full opacity-50 group-hover:opacity-100 transition-opacity"></div></div><div class="space-y-2"><p class="text-sm font-semibold text-rose-700/80 uppercase tracking-wider">Pacotes Vencidos</p><p class="text-3xl font-black text-gray-900 tracking-tight">{{ metricas.pacotesVencidos}}</p><div class="flex items-center gap-2 text-rose-600"><div class="w-1 h-1 bg-rose-500 rounded-full"></div><p class="text-xs font-medium">Aten√ß√£o necess√°ria</p></div></div></div></div><div class="group relative overflow-hidden rounded-3xl bg-gradient-to-br from-sky-50/80 to-blue-100/80 backdrop-blur-sm border border-sky-200/50 p-8 hover:shadow-2xl hover:shadow-sky-500/10 transition-all duration-500 hover:-translate-y-2"><div class="absolute inset-0 bg-gradient-to-br from-sky-400/5 to-blue-600/5"></div><div class="relative"><div class="flex items-start justify-between mb-6"><div class="p-4 bg-gradient-to-br from-sky-500 to-blue-600 rounded-2xl shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'bath']" class="text-white text-2xl" /></div><div class="w-2 h-2 bg-sky-400 rounded-full opacity-50 group-hover:opacity-100 transition-opacity"></div></div><div class="space-y-2"><p class="text-sm font-semibold text-sky-700/80 uppercase tracking-wider">Banhos do M√™s</p><p class="text-3xl font-black text-gray-900 tracking-tight">{{ metricas.banhosRealizados}}</p><div class="flex items-center gap-2 text-sky-600"><div class="w-1 h-1 bg-sky-500 rounded-full"></div><p class="text-xs font-medium">{{ new Date().toLocaleDateString('pt-BR',{ month: 'long', year: 'numeric'})}}</p></div></div></div></div></div><div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12"><div class="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-sm border border-gray-200/50 p-8 shadow-2xl"><div class="absolute inset-0 bg-gradient-to-br from-indigo-50/30 to-purple-50/30"></div><div class="relative"><div class="flex items-center gap-3 mb-8"><div class="p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-2xl shadow-lg"><FontAwesomeIcon :icon="['fas', 'users']" class="text-white text-xl" /></div><h3 class="text-xl font-black text-gray-900 tracking-tight">Base de Clientes</h3></div><div class="space-y-6"><div class="group flex items-center justify-between p-5 bg-gradient-to-r from-indigo-50/80 to-blue-50/80 rounded-2xl border border-indigo-100/50 hover:shadow-lg transition-all duration-300"><div class="flex items-center gap-4"><div class="p-3 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl shadow-md group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'user']" class="text-white text-lg" /></div><span class="font-semibold text-gray-800">Clientes</span></div><span class="text-2xl font-black text-gray-900">{{ metricas.totalClientes}}</span></div><div class="group flex items-center justify-between p-5 bg-gradient-to-r from-emerald-50/80 to-green-50/80 rounded-2xl border border-emerald-100/50 hover:shadow-lg transition-all duration-300"><div class="flex items-center gap-4"><div class="p-3 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl shadow-md group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'paw']" class="text-white text-lg" /></div><span class="font-semibold text-gray-800">Animais</span></div><span class="text-2xl font-black text-gray-900">{{ metricas.totalAnimais}}</span></div><div class="group flex items-center justify-between p-5 bg-gradient-to-r from-violet-50/80 to-purple-50/80 rounded-2xl border border-violet-100/50 hover:shadow-lg transition-all duration-300"><div class="flex items-center gap-4"><div class="p-3 bg-gradient-to-br from-violet-500 to-purple-600 rounded-xl shadow-md group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'clipboard-list']" class="text-white text-lg" /></div><span class="font-semibold text-gray-800">Servi√ßos</span></div><span class="text-2xl font-black text-gray-900">{{ metricas.totalServicos}}</span></div></div></div></div><div class="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-sm border border-gray-200/50 p-8 shadow-2xl lg:col-span-2"><div class="absolute inset-0 bg-gradient-to-br from-purple-50/20 to-pink-50/20"></div><div class="relative"><div class="flex items-center gap-3 mb-8"><div class="p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl shadow-lg"><FontAwesomeIcon :icon="['fas', 'box']" class="text-white text-xl" /></div><h3 class="text-xl font-black text-gray-900 tracking-tight">Status dos Pacotes</h3></div><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-50/80 to-green-50/80 border border-emerald-200/50 p-6 hover:shadow-xl transition-all duration-500 hover:-translate-y-1"><div class="absolute inset-0 bg-gradient-to-br from-emerald-400/5 to-green-600/5"></div><div class="relative text-center"><div class="w-14 h-14 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'check-circle']" class="text-white text-xl" /></div><p class="text-3xl font-black text-emerald-800 mb-2">{{ metricas.pacotesValidos}}</p><p class="text-sm font-semibold text-emerald-600 uppercase tracking-wider">V√°lidos</p></div></div><div class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-amber-50/80 to-yellow-50/80 border border-amber-200/50 p-6 hover:shadow-xl transition-all duration-500 hover:-translate-y-1"><div class="absolute inset-0 bg-gradient-to-br from-amber-400/5 to-yellow-600/5"></div><div class="relative text-center"><div class="w-14 h-14 bg-gradient-to-br from-amber-500 to-yellow-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300 animate-pulse"><FontAwesomeIcon :icon="['fas', 'clock']" class="text-white text-xl" /></div><p class="text-3xl font-black text-amber-800 mb-2">{{ metricas.pacotesVencendo}}</p><p class="text-sm font-semibold text-amber-600 uppercase tracking-wider">Vencendo</p></div></div><div class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-rose-50/80 to-red-50/80 border border-rose-200/50 p-6 hover:shadow-xl transition-all duration-500 hover:-translate-y-1"><div class="absolute inset-0 bg-gradient-to-br from-rose-400/5 to-red-600/5"></div><div class="relative text-center"><div class="w-14 h-14 bg-gradient-to-br from-rose-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'exclamation-triangle']" class="text-white text-xl" /></div><p class="text-3xl font-black text-rose-800 mb-2">{{ metricas.pacotesVencidos}}</p><p class="text-sm font-semibold text-rose-600 uppercase tracking-wider">Vencidos</p></div></div></div></div></div></div><div class="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-sm border border-gray-200/50 p-8 shadow-2xl mb-12"><div class="absolute inset-0 bg-gradient-to-br from-yellow-50/20 to-orange-50/20"></div><div class="relative"><div class="flex items-center gap-3 mb-8"><div class="p-3 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-2xl shadow-lg"><FontAwesomeIcon :icon="['fas', 'zap']" class="text-white text-xl" /></div><h3 class="text-xl font-black text-gray-900 tracking-tight">A√ß√µes R√°pidas</h3></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"><button @click="$router.push('/animal-servico/novo')" class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-blue-50/80 to-indigo-50/80 border border-blue-200/50 p-6 hover:shadow-2xl hover:shadow-blue-500/10 transition-all duration-500 hover:-translate-y-2 active:scale-95" ><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div><div class="relative text-center"><div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'plus']" class="text-white text-2xl" /></div><p class="font-black text-gray-900 text-lg mb-1">Novo Servi√ßo</p><p class="text-sm text-gray-600 font-medium">Registrar atendimento</p></div></button><button @click="$router.push('/clientes/novo')" class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-50/80 to-green-50/80 border border-emerald-200/50 p-6 hover:shadow-2xl hover:shadow-emerald-500/10 transition-all duration-500 hover:-translate-y-2 active:scale-95" ><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div><div class="relative text-center"><div class="w-16 h-16 bg-gradient-to-br from-emerald-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'user-plus']" class="text-white text-2xl" /></div><p class="font-black text-gray-900 text-lg mb-1">Novo Cliente</p><p class="text-sm text-gray-600 font-medium">Cadastrar pessoa</p></div></button><button @click="$router.push('/animais/novo')" class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-violet-50/80 to-purple-50/80 border border-violet-200/50 p-6 hover:shadow-2xl hover:shadow-violet-500/10 transition-all duration-500 hover:-translate-y-2 active:scale-95" ><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div><div class="relative text-center"><div class="w-16 h-16 bg-gradient-to-br from-violet-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'paw']" class="text-white text-2xl" /></div><p class="font-black text-gray-900 text-lg mb-1">Novo Animal</p><p class="text-sm text-gray-600 font-medium">Cadastrar pet</p></div></button><button @click="$router.push('/animal-servico')" class="group relative overflow-hidden rounded-2xl bg-gradient-to-br from-orange-50/80 to-amber-50/80 border border-orange-200/50 p-6 hover:shadow-2xl hover:shadow-orange-500/10 transition-all duration-500 hover:-translate-y-2 active:scale-95" ><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div><div class="relative text-center"><div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'list']" class="text-white text-2xl" /></div><p class="font-black text-gray-900 text-lg mb-1">Ver Servi√ßos</p><p class="text-sm text-gray-600 font-medium">Gerenciar lista</p></div></button></div></div><div v-if="atividadeRecente.length >0" class="relative overflow-hidden rounded-3xl bg-white/70 backdrop-blur-sm border border-gray-200/50 p-8 shadow-2xl"><div class="absolute inset-0 bg-gradient-to-br from-cyan-50/20 to-blue-50/20"></div><div class="relative"><div class="flex items-center gap-3 mb-8"><div class="p-3 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl shadow-lg"><FontAwesomeIcon :icon="['fas', 'clock']" class="text-white text-xl" /></div><h3 class="text-xl font-black text-gray-900 tracking-tight">Atividade Recente</h3></div><div class="space-y-4"><div v-for="(atividade, index) in atividadeRecente.slice(0, 5)" :key="index" class="group flex items-center gap-4 p-5 bg-gradient-to-r from-gray-50/80 to-slate-50/80 rounded-2xl border border-gray-200/50 hover:shadow-lg transition-all duration-300 hover:-translate-y-1" ><div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center shadow-md group-hover:scale-110 transition-transform duration-300"><FontAwesomeIcon :icon="['fas', 'bath']" class="text-white text-lg" /></div><div class="flex-1"><p class="font-semibold text-gray-900 text-lg">{{ atividade.descricao}}</p><p class="text-sm text-gray-600 font-medium">{{ atividade.tempo}}</p></div></div></div></div></div></div></div><footer class="relative z-10 mt-16 border-t border-gray-200/50 bg-gradient-to-r from-white/40 via-gray-50/40 to-white/40 backdrop-blur-sm"><div class="max-w-7xl mx-auto px-4 py-8"><div class="flex flex-col md:flex-row items-center justify-between gap-6"><div class="flex items-center gap-3"><div class="w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center shadow-md"><span class="text-white text-lg font-bold">üêï</span></div><div><p class="font-black text-gray-900 text-lg tracking-tight">ProntoDog</p><p class="text-xs text-gray-500 font-medium">Sistema de Gest√£o Pet</p></div></div><div class="flex items-center gap-8 text-sm"><button @click="$router.push('/animal-servico')" class="text-gray-600 hover:text-indigo-600 font-medium transition-colors duration-200 flex items-center gap-2" ><FontAwesomeIcon :icon="['fas', 'clipboard-list']" class="w-4 h-4" />Servi√ßos </button><button @click="$router.push('/clientes')" class="text-gray-600 hover:text-emerald-600 font-medium transition-colors duration-200 flex items-center gap-2" ><FontAwesomeIcon :icon="['fas', 'users']" class="w-4 h-4" />Clientes </button><button @click="$router.push('/animais')" class="text-gray-600 hover:text-purple-600 font-medium transition-colors duration-200 flex items-center gap-2" ><FontAwesomeIcon :icon="['fas', 'paw']" class="w-4 h-4" />Animais </button></div><div class="text-center md:text-right"><p class="text-xs text-gray-500 font-medium">Desenvolvido com ‚ù§Ô∏è para o cuidado dos pets </p><p class="text-xs text-gray-400 mt-1 flex items-center justify-center md:justify-end gap-1"><FontAwesomeIcon :icon="['fas', 'calendar-alt']" class="w-3 h-3" />¬©{{ new Date().getFullYear()}} ProntoDog - Todos os direitos reservados </p></div></div><div class="mt-6 pt-4 border-t border-gray-200/30"><div class="flex items-center justify-center"><div class="flex items-center gap-2 text-xs text-gray-400"><div class="w-1 h-1 bg-indigo-400 rounded-full opacity-60"></div><span>Dashboard v2.0</span><div class="w-1 h-1 bg-emerald-400 rounded-full opacity-60"></div><span>Sistema Integrado</span><div class="w-1 h-1 bg-purple-400 rounded-full opacity-60"></div></div></div></div></div></footer><div class="fixed bottom-6 right-6 z-50"><button @click="$router.push('/configuracoes')" class="group w-14 h-14 bg-gradient-to-r from-slate-700 to-gray-800 rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 border border-white/20" title="Configura√ß√µes" ><FontAwesomeIcon :icon="['fas', 'cog']" class="text-white text-xl group-hover:rotate-180 transition-transform duration-300" /></button></div></div></template><script setup lang="ts">import{ ref, computed, onMounted} from 'vue'import BaseCard from '@/components/UI/BaseCard.vue'import{ animaisService, clientesService, animalServicoService, servicosService} from '@/services/api'import type{ Animal, Cliente, AnimalServico, ServicoCompleto} from '@/types/api'// üìä Estados Reativosconst loading=ref(true)const error=ref('')// üìà Dados da APIconst animais=ref<Animal[]>([])const clientes=ref<Cliente[]>([])const animalServicos=ref<AnimalServico[]>([])const servicos=ref<ServicoCompleto[]>([])// üïê Data e Sauda√ß√£oconst saudacao=computed(()=>{ const hora=new Date().getHours() if (hora < 12) return 'Bom dia' if (hora < 18) return 'Boa tarde' return 'Boa noite'})const dataAtual=computed(()=>{ return new Date().toLocaleDateString('pt-BR',{ weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'})})// üìä M√©tricas Calculadasconst metricas=computed(()=>{ // üìÖ Filtro do m√™s atual const hoje=new Date() const anoAtual=hoje.getFullYear() const mesAtual=hoje.getMonth() + 1 // getMonth() retorna 0-11, precisamos 1-12 console.log(`üìÖ Calculando m√©tricas para: ${mesAtual}/${anoAtual}`) // üêõ Debug: Log dos dados para entender o problema console.log('üîç Debug - Calculando m√©tricas:',{ animalServicos: animalServicos.value.length, servicos: servicos.value.length}) // Log da estrutura dos objetos if (animalServicos.value[0]){ console.log('üìã Primeiro AnimalServico:', animalServicos.value[0]) console.log('üîó Chaves do AnimalServico:', Object.keys(animalServicos.value[0]))} if (servicos.value[0]){ console.log('üíº Primeiro Servico:', servicos.value[0]) console.log('üîó Chaves do Servico:', Object.keys(servicos.value[0]))} // Log de todos os IDs de servi√ßos dispon√≠veis const idsServicosDisponiveis=servicos.value.map(s=>s.id) const servicoIdsReferenciados=animalServicos.value.map(as=>as.servicoId || 'UNDEFINED') console.log('üÜî IDs dos servi√ßos dispon√≠veis:', idsServicosDisponiveis) console.log('üÜî servicoIds dos animalServicos:', servicoIdsReferenciados) console.log('üîß Detalhes dos servi√ßos dispon√≠veis:', servicos.value.map(s=>({ id: s.id, nome: s.nome, valor: s.valor}))) // Encontrar IDs √≥rf√£os const idsOrfaos=servicoIdsReferenciados.filter(id=>id !=='UNDEFINED' && !idsServicosDisponiveis.includes(id) ) console.log('üíÄ IDs √≥rf√£os (n√£o existem na tabela servico):', idsOrfaos) // Contar quantos animalServicos t√™m relacionamento v√°lido const animalServicosValidos=animalServicos.value.filter(as=>as.servicoId && idsServicosDisponiveis.includes(as.servicoId) ) console.log('‚úÖ AnimalServicos com relacionamento v√°lido:', animalServicosValidos.length) // Mostrar um exemplo de animalServico com problema const animalServicoComProblema=animalServicos.value.find(as=>as.servicoId && !idsServicosDisponiveis.includes(as.servicoId) ) if (animalServicoComProblema){ console.log('üö® Exemplo de AnimalServico com problema:', animalServicoComProblema)} // Fun√ß√£o para verificar se √© do m√™s atual (para cadastro de servi√ßos) const isServicoDoMesAtual=(dataServico: string)=>{ const data=new Date(dataServico + 'T00:00:00') const isDoMes=data.getFullYear()===anoAtual && (data.getMonth() + 1)===mesAtual if (isDoMes){ console.log(`üìÖ Servi√ßo cadastrado no m√™s: ${dataServico}`)} return isDoMes} // Fun√ß√£o para verificar se foi PAGO no m√™s atual (para receita) const isPagamentoDoMesAtual=(dataPagamento: string | null)=>{ if (!dataPagamento) return false const data=new Date(dataPagamento + 'T00:00:00') const isDoMes=data.getFullYear()===anoAtual && (data.getMonth() + 1)===mesAtual if (isDoMes){ console.log(`üí∞ Pagamento realizado no m√™s: ${dataPagamento}`)} return isDoMes} // Filtrar apenas animalServicos com relacionamento v√°lido const animalServicosComRelacao=animalServicos.value.filter(as=>{ // Tenta acessar servicoId ou servico.id const servicoId=as.servicoId || as.servico?.id console.log(`üîç AnimalServico ${as.id}: servicoId=${as.servicoId}, servico.id=${as.servico?.id}, servicoValido=${!!servicoId}`) return servicoId && idsServicosDisponiveis.includes(servicoId)}) // Log das datas de todos os servi√ßos v√°lidos para ver o padr√£o console.log('üìÖ Datas dos servi√ßos v√°lidos:', animalServicosComRelacao.map(as=>({ id: as.id, dataServico: as.dataServico, statusPagamento: as.statusPagamento}))) // Separar l√≥gicas diferentes: // 1. Servi√ßos cadastrados no m√™s (para "em aberto" e "banhos realizados") const animalServicosCadastradosNoMes=animalServicosComRelacao.filter(as=>isServicoDoMesAtual(as.dataServico) ) // 2. Servi√ßos PAGOS no m√™s (para "receita total") - baseado na dataPagamento const animalServicosPagosNoMes=animalServicosComRelacao.filter(as=>as.statusPagamento==='pago' && isPagamentoDoMesAtual(as.dataPagamento || null) ) console.log(`üìä Trabalhando com ${animalServicosComRelacao.length}/${animalServicos.value.length} AnimalServicos v√°lidos`) console.log(`üìÖ Cadastrados no m√™s: ${animalServicosCadastradosNoMes.length}`) console.log(`üí∞ Pagos no m√™s: ${animalServicosPagosNoMes.length}`) // C√°lculos corretos: // - Receita: Servi√ßos pagos no m√™s (por dataPagamento) // - Em Aberto: Servi√ßos cadastrados no m√™s que est√£o em aberto const servicosPagos=animalServicosPagosNoMes // J√° filtrados por pagamento do m√™s const servicosEmAberto=animalServicosCadastradosNoMes.filter(s=>s.statusPagamento==='em_aberto') // Para pacotes vencidos, usar todos os v√°lidos (n√£o apenas do m√™s) const todosServicosValidos=animalServicosComRelacao.filter(s=>s.statusPagamento !=='cancelado') console.log('üí∞ Status dos pagamentos (m√™s atual):',{ cadastradosNoMes: animalServicosCadastradosNoMes.length, pagosNoMes: servicosPagos.length, emAbertoNoMes: servicosEmAberto.length, canceladosNoMes: animalServicosCadastradosNoMes.filter(s=>s.statusPagamento==='cancelado').length}) // Log detalhado dos servi√ßos pagos console.log('üí≥ Servi√ßos PAGOS do m√™s (por dataPagamento):', servicosPagos.map(s=>({ id: s.id, dataServico: s.dataServico, dataPagamento: s.dataPagamento, servicoId: s.servicoId, statusPagamento: s.statusPagamento}))) // Log detalhado dos servi√ßos em aberto console.log('‚è≥ Servi√ßos EM ABERTO do m√™s (por dataServico):', servicosEmAberto.map(s=>({ id: s.id, dataServico: s.dataServico, dataPagamento: s.dataPagamento, servicoId: s.servicoId, statusPagamento: s.statusPagamento}))) // Fun√ß√£o helper para encontrar valor do servi√ßo const obterValorServico=(animalServico: any)=>{ const servicoId=animalServico.servicoId || animalServico.servico?.id console.log(`üîç Buscando valor para AnimalServico ${animalServico.id}:`,{ servicoId: animalServico.servicoId, servicoObjectId: animalServico.servico?.id, servicoIdFinal: servicoId, hasServicoEmbed: !!animalServico.servico, servicoEmbedValor: animalServico.servico?.valor}) // Primeiro tenta pelo servicoId (ou servico.id) if (servicoId){ const servicoInfo=servicos.value.find(s=>s.id===servicoId) if (servicoInfo){ console.log(`‚úÖ Valor encontrado via servicoId/servico.id: R$ ${servicoInfo.valor}`) return servicoInfo.valor} else{ console.log(`‚ö†Ô∏è ServiceId ${servicoId} n√£o encontrado na lista de servi√ßos`) console.log('üîç Servi√ßos dispon√≠veis:', servicos.value.map(s=>s.id))}} // Se n√£o encontrou, tenta pelo objeto servico embed valor direto if (animalServico.servico?.valor){ console.log(`‚úÖ Valor encontrado via embed direto: R$ ${animalServico.servico.valor}`) return animalServico.servico.valor} console.log(`‚ùå FALHA: Valor n√£o encontrado para AnimalServico ID ${animalServico.id}`) return 0} const receitaTotal=servicosPagos.reduce((total, servico)=>{ const valor=obterValorServico(servico) if (valor >0){ console.log(`‚úÖ Receita: R$ ${valor} do servi√ßo ID ${servico.id}`)} return total + valor}, 0) const valorEmAberto=servicosEmAberto.reduce((total, servico)=>{ const valor=obterValorServico(servico) if (valor >0){ console.log(`üìã Em aberto: R$ ${valor} do servi√ßo ID ${servico.id}`)} return total + valor}, 0) console.log('üí∞ RESULTADO - C√°lculos financeiros do m√™s:',{ receitaTotal: `R$ ${receitaTotal}`, valorEmAberto: `R$ ${valorEmAberto}`, servicosPagosCount: servicosPagos.length, servicosEmAbertoCount: servicosEmAberto.length, mesAtual: `${mesAtual}/${anoAtual}`}) if (receitaTotal===0 && servicosPagos.length >0){ console.log('üö® PROBLEMA DETECTADO: H√° servi√ßos pagos mas receita=0!') console.log('üîç Primeiro servi√ßo pago:', servicosPagos[0])} if (valorEmAberto===0 && servicosEmAberto.length >0){ console.log('üö® PROBLEMA DETECTADO: H√° servi√ßos em aberto mas valor=0!') console.log('üîç Primeiro servi√ßo em aberto:', servicosEmAberto[0])} // C√°lculos de banhos (servi√ßos cadastrados no m√™s atual) const totalBanhosRealizados=animalServicosCadastradosNoMes.reduce((total, servico)=>{ return total + (servico.banhosUsados || 0)}, 0) // Status de pacotes - fun√ß√£o helper para obter quantidade do servi√ßo const obterQuantidadeServico=(animalServico: any)=>{ const servicoId=animalServico.servicoId || animalServico.servico?.id // Primeiro tenta pelo servicoId (ou servico.id) if (servicoId){ const servicoInfo=servicos.value.find(s=>s.id===servicoId) if (servicoInfo) return servicoInfo.quantidade} // Se n√£o encontrou, tenta pelo objeto servico embed if (animalServico.servico?.quantidade){ return animalServico.servico.quantidade} return 1 // Default para banho √∫nico} const servicosComExpiracao=todosServicosValidos.filter(s=>{ const quantidade=obterQuantidadeServico(s) return s.dataExpiracao && quantidade >1}) console.log('üì¶ Servi√ßos com expira√ß√£o:',{ total: servicosComExpiracao.length, servicos: servicosComExpiracao.map(s=>({ id: s.id, dataExpiracao: s.dataExpiracao, quantidade: obterQuantidadeServico(s)}))}) const pacotesVencidos=servicosComExpiracao.filter(servico=>{ if (!servico.dataExpiracao) return false const dataExpiracao=new Date(servico.dataExpiracao + 'T23:59:59') return dataExpiracao < hoje}).length const pacotesVencendo=servicosComExpiracao.filter(servico=>{ if (!servico.dataExpiracao) return false const dataExpiracao=new Date(servico.dataExpiracao + 'T23:59:59') const diasRestantes=Math.ceil((dataExpiracao.getTime() - hoje.getTime()) / (1000 * 60 * 60 * 24)) return diasRestantes >=0 && diasRestantes <=7}).length const pacotesValidos=servicosComExpiracao.filter(servico=>{ if (!servico.dataExpiracao) return false const dataExpiracao=new Date(servico.dataExpiracao + 'T23:59:59') const diasRestantes=Math.ceil((dataExpiracao.getTime() - hoje.getTime()) / (1000 * 60 * 60 * 24)) return diasRestantes >7}).length console.log('üì¶ Status dos pacotes:',{ vencidos: pacotesVencidos, vencendo: pacotesVencendo, validos: pacotesValidos}) const resultado={ // Financeiro receitaTotal, valorEmAberto, servicosEmAberto: servicosEmAberto.length, // Totais totalClientes: clientes.value.length, totalAnimais: animais.value.length, totalServicos: animalServicosCadastradosNoMes.length, banhosRealizados: totalBanhosRealizados, // Pacotes pacotesVencidos, pacotesVencendo, pacotesValidos} console.log('üìä M√©tricas finais:', resultado) return resultado})// üìã Atividade Recenteconst atividadeRecente=computed(()=>{ const atividades: Array<{ descricao: string; tempo: string}>=[] // Pegar os √∫ltimos 10 servi√ßos ordenados por data const servicosRecentes=animalServicos.value .sort((a, b)=>new Date(b.dataServico).getTime() - new Date(a.dataServico).getTime()) .slice(0, 10) servicosRecentes.forEach(servico=>{ const animal=animais.value.find(a=>a.id===servico.animalId) const servicoInfo=servicos.value.find(s=>s.id===servico.servicoId) const cliente=clientes.value.find(c=>c.id===animal?.cliente?.id) if (animal && servicoInfo && cliente){ const dataServico=new Date(servico.dataServico) const tempo=formatarTempoRelativo(dataServico) atividades.push({ descricao: `${servicoInfo.nome} para ${animal.nome} (${cliente.nomeCompleto})`, tempo})}}) return atividades})// üõ†Ô∏è Fun√ß√µes Auxiliaresconst formatarValor=(valor: number): string=>{ return new Intl.NumberFormat('pt-BR',{ style: 'currency', currency: 'BRL'}).format(valor)}const formatarTempoRelativo=(data: Date): string=>{ const agora=new Date() const diffMs=agora.getTime() - data.getTime() const diffDias=Math.floor(diffMs / (1000 * 60 * 60 * 24)) if (diffDias===0) return 'Hoje' if (diffDias===1) return 'Ontem' if (diffDias < 7) return `${diffDias} dias atr√°s` if (diffDias < 30) return `${Math.floor(diffDias / 7)} semanas atr√°s` return `${Math.floor(diffDias / 30)} meses atr√°s`}// üîÑ Carregamento de Dadosconst carregarDados=async ()=>{ try{ loading.value=true error.value='' console.log('üöÄ Carregando dados da dashboard...') // Buscar dados em paralelo const [ animaisData, clientesData, animalServicosData, servicosData ]=await Promise.all([ animaisService.buscarTodos(), clientesService.buscarTodos(), animalServicoService.buscarTodos(), servicosService.buscarTodos() ]) // Atualizar dados reativos animais.value=animaisData clientes.value=clientesData animalServicos.value=animalServicosData servicos.value=servicosData console.log('‚úÖ Dados carregados com sucesso!') console.log({ animais: animaisData.length, clientes: clientesData.length, animalServicos: animalServicosData.length, servicos: servicosData.length})} catch (err){ console.error('‚ùå Erro ao carregar dados da dashboard:', err) error.value='Erro ao carregar dados. Tente novamente.'} finally{ loading.value=false}}// üéØ LifecycleonMounted(()=>{ carregarDados()})</script>